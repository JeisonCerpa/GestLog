<Window x:Class="GestLog.Views.Tools.GestionEquipos.CrearPlanCronogramaDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:converters="clr-namespace:GestLog.Converters"
        Title="Crear Plan de Cronograma" Height="Auto" Width="600" MinHeight="500" MinWidth="500" 
        WindowStartupLocation="CenterOwner"
        ResizeMode="CanResize" WindowStyle="SingleBorderWindow" Background="#FAFAFA" SizeToContent="Height">
    
    <Window.Resources>
        <converters:StringToVisibilityConverter x:Key="StringToVisibilityConverter" />
        <converters:InverseBooleanConverter x:Key="InverseBooleanConverter" />
        <converters:BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />
        <converters:InverseBooleanToVisibilityConverter x:Key="InverseBooleanToVisibilityConverter" />
        <converters:BooleanToStringConverter x:Key="BooleanToStringConverter" />
    </Window.Resources>
    
    <Border Margin="16" Background="White" CornerRadius="8" Padding="20" BorderBrush="#DDD" BorderThickness="1">
        <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
            <StackPanel>
                <TextBlock Text="Crear Plan de Cronograma" FontSize="20" FontWeight="Bold" Foreground="#118938" Margin="0,0,0,18"/>
                
                <!-- Información contextual -->
                <Border Background="#E8F5E8" BorderBrush="#118938" BorderThickness="1" CornerRadius="4" Padding="10" Margin="0,0,0,16">
                    <StackPanel>
                        <TextBlock Text="📅 Información de Semana Actual" FontWeight="Bold" Foreground="#118938" Margin="0,0,0,4"/>
                        <TextBlock x:Name="InfoSemanaTextBlock" Text="{Binding InfoSemanaActual}" Foreground="#555" FontSize="12"/>
                    </StackPanel>
                </Border>

                <Grid Margin="0,0,0,10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="140"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Código del Equipo -->
                    <TextBlock Text="Código Equipo:*" Grid.Row="0" Grid.Column="0" VerticalAlignment="Center" FontWeight="Bold"/>
                    <TextBox Text="{Binding CodigoEquipo, UpdateSourceTrigger=PropertyChanged}" 
                             Grid.Row="0" Grid.Column="1" Margin="0,4" Padding="8"
                             ToolTip="Código único del equipo informático"/>

                    <!-- Descripción -->
                    <TextBlock Text="Descripción:*" Grid.Row="1" Grid.Column="0" VerticalAlignment="Top" FontWeight="Bold" Margin="0,8,0,0"/>
                    <TextBox Text="{Binding Descripcion, UpdateSourceTrigger=PropertyChanged}" 
                             Grid.Row="1" Grid.Column="1" Margin="0,4" Padding="8"
                             Height="60" AcceptsReturn="True" TextWrapping="Wrap" VerticalScrollBarVisibility="Auto"
                             ToolTip="Descripción detallada del plan de mantenimiento"/>

                    <!-- Responsable -->
                    <TextBlock Text="Responsable:*" Grid.Row="2" Grid.Column="0" VerticalAlignment="Center" FontWeight="Bold"/>
                    <TextBox Text="{Binding Responsable, UpdateSourceTrigger=PropertyChanged}" 
                             Grid.Row="2" Grid.Column="1" Margin="0,4" Padding="8"
                             ToolTip="Persona responsable de ejecutar el plan"/>

                    <!-- Día de Ejecución -->
                    <TextBlock Text="Día Ejecución:" Grid.Row="3" Grid.Column="0" VerticalAlignment="Center" FontWeight="Bold"/>
                    <ComboBox ItemsSource="{Binding DiasDisponibles}"
                              SelectedValue="{Binding DiaEjecucion, UpdateSourceTrigger=PropertyChanged}"
                              SelectedValuePath="Valor"
                              DisplayMemberPath="Nombre"
                              Grid.Row="3" Grid.Column="1" Margin="0,4" Padding="8"
                              ToolTip="Día de la semana preferido para ejecutar el plan"/>

                    <!-- Checklist JSON -->
                    <TextBlock Text="Checklist (JSON):" Grid.Row="4" Grid.Column="0" VerticalAlignment="Top" FontWeight="Bold" Margin="0,8,0,0"/>
                    <TextBox Text="{Binding ChecklistJson, UpdateSourceTrigger=PropertyChanged}" 
                             Grid.Row="4" Grid.Column="1" Margin="0,4" Padding="8"
                             Height="120" AcceptsReturn="True" TextWrapping="Wrap" VerticalScrollBarVisibility="Auto"
                             FontFamily="Consolas" FontSize="11"
                             ToolTip="Lista de verificación en formato JSON (opcional)"/>

                    <!-- Mensaje de estado -->
                    <TextBlock Text="{Binding StatusMessage}" Grid.Row="5" Grid.Column="0" Grid.ColumnSpan="2" 
                               Margin="0,8,0,0" Foreground="#D32F2F" FontWeight="Bold" TextWrapping="Wrap"
                               Visibility="{Binding StatusMessage, Converter={StaticResource StringToVisibilityConverter}}"/>
                </Grid>

                <!-- Información adicional -->
                <Border Background="#F5F5F5" BorderBrush="#DDD" BorderThickness="1" CornerRadius="4" Padding="10" Margin="0,16,0,0">
                    <StackPanel>
                        <TextBlock Text="ℹ️ Información sobre Planes de Cronograma" FontWeight="Bold" Foreground="#555" Margin="0,0,0,8"/>
                        <TextBlock Text="• Los planes definen actividades de mantenimiento que se ejecutan de forma programada" Foreground="#666" TextWrapping="Wrap" Margin="0,2"/>
                        <TextBlock Text="• El día de ejecución indica cuándo de la semana se debe realizar preferiblemente" Foreground="#666" TextWrapping="Wrap" Margin="0,2"/>
                        <TextBlock Text="• El checklist JSON es opcional y puede contener tareas específicas a verificar" Foreground="#666" TextWrapping="Wrap" Margin="0,2"/>
                        <TextBlock Text="• Los campos marcados con * son obligatorios" Foreground="#666" TextWrapping="Wrap" Margin="0,2"/>
                    </StackPanel>
                </Border>

                <!-- Botones -->
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,20,0,0">
                    <Button Content="Cancelar" Name="BtnCancelar" Padding="16,8" Margin="0,0,10,0" MinWidth="100"
                            Background="#F5F5F5" BorderBrush="#DDD" Foreground="#333"
                            Style="{StaticResource {x:Type Button}}" Click="BtnCancelar_Click"/>                    <Button Command="{Binding CrearPlanCommand}" 
                            Padding="16,8" MinWidth="100" Background="#118938" BorderBrush="#118938" Foreground="White"
                            IsEnabled="{Binding IsSaving, Converter={StaticResource InverseBooleanConverter}}"
                            Style="{StaticResource {x:Type Button}}">
                        <Button.Content>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="📋" Margin="0,0,6,0" Visibility="{Binding IsSaving, Converter={StaticResource InverseBooleanToVisibilityConverter}}"/>
                                <TextBlock Text="⏳" Margin="0,0,6,0" Visibility="{Binding IsSaving, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                                <TextBlock Text="{Binding IsSaving, Converter={StaticResource BooleanToStringConverter}, ConverterParameter='Creando...|Crear Plan'}"/>
                            </StackPanel>
                        </Button.Content>
                    </Button>
                </StackPanel>
            </StackPanel>
        </ScrollViewer>
    </Border>
</Window>
