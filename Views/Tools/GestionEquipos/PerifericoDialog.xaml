<Window x:Class="GestLog.Views.Tools.GestionEquipos.PerifericoDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:conv="clr-namespace:GestLog.Converters"
        mc:Ignorable="d"        Title="{Binding TituloDialog}" 
        Height="700" Width="900"
        MinHeight="600" MinWidth="800"
        WindowStartupLocation="CenterOwner"
        ResizeMode="CanResize"
        Background="#FAFAFA">

    <Window.Resources>
        <conv:EnumToDescriptionConverter x:Key="EnumToDescriptionConverter"/>
        <conv:BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
          <!-- Paleta de colores GestLog -->
        <SolidColorBrush x:Key="PrimaryBrush" Color="#118938"/>
        <SolidColorBrush x:Key="SecondaryBrush" Color="#2B8E3F"/>
        <SolidColorBrush x:Key="TextPrimaryBrush" Color="#504F4E"/>
        <SolidColorBrush x:Key="TextSecondaryBrush" Color="#706F6F"/>
        <SolidColorBrush x:Key="SurfaceBrush" Color="#FFFFFF"/>
        <SolidColorBrush x:Key="BorderBrush" Color="#E2E8F0"/>
        <SolidColorBrush x:Key="ErrorBrush" Color="#C0392B"/>
        
        <!-- Efecto de sombra sutil -->
        <DropShadowEffect x:Key="CardShadow" 
                          Color="#20000000" 
                          BlurRadius="8" 
                          ShadowDepth="2" 
                          Direction="270"/>
        
        <!-- Estilos -->
        <Style x:Key="HeaderTextStyle" TargetType="TextBlock">
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="20"/>
            <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
        </Style>
        
        <Style x:Key="LabelTextStyle" TargetType="TextBlock">
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="Medium"/>
            <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
            <Setter Property="Margin" Value="0,0,0,8"/>
        </Style>
          <Style x:Key="InputStyle" TargetType="Control">
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Padding" Value="12,10"/>
            <Setter Property="Margin" Value="0,0,0,20"/>
            <Setter Property="Height" Value="42"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Background" Value="{StaticResource SurfaceBrush}"/>
            <Style.Triggers>
                <Trigger Property="IsFocused" Value="True">
                    <Setter Property="BorderBrush" Value="{StaticResource PrimaryBrush}"/>
                    <Setter Property="BorderThickness" Value="2"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        
        <Style x:Key="SectionHeaderStyle" TargetType="TextBlock">
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
            <Setter Property="Margin" Value="0,0,0,20"/>
        </Style>
        
        <Style x:Key="PrimaryButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="{StaticResource PrimaryBrush}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="Medium"/>
            <Setter Property="Height" Value="40"/>
            <Setter Property="MinWidth" Value="120"/>
            <Setter Property="Padding" Value="16,0"/>
            <Setter Property="Margin" Value="8,0"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                CornerRadius="6">
                            <ContentPresenter HorizontalAlignment="Center"
                                            VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="{StaticResource SecondaryBrush}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        
        <Style x:Key="SecondaryButtonStyle" TargetType="Button" BasedOn="{StaticResource PrimaryButtonStyle}">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}"/>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="80"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="80"/>
        </Grid.RowDefinitions>
        
        <!-- Header -->
        <Border Grid.Row="0" Background="{StaticResource PrimaryBrush}">
            <Grid Margin="32,16">
                <TextBlock Text="{Binding TituloDialog}" 
                          Style="{StaticResource HeaderTextStyle}"
                          Foreground="White"/>
            </Grid>
        </Border>
          <!-- Content -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Padding="24">
            <StackPanel>
                  <!-- Sección: Información Básica -->
                <Border Background="{StaticResource SurfaceBrush}" 
                        CornerRadius="8" 
                        BorderBrush="{StaticResource BorderBrush}" 
                        BorderThickness="1"
                        Effect="{StaticResource CardShadow}"
                        Padding="24">
                    <StackPanel>                        <TextBlock Text="📋 Información Básica" 
                                   Style="{StaticResource SectionHeaderStyle}"/>
                        
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="16"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <!-- Fila 1: Código y Dispositivo -->
                            <StackPanel Grid.Row="0" Grid.Column="0">
                                <TextBlock Text="Código *" Style="{StaticResource LabelTextStyle}"/>
                                <TextBox x:Name="TxtCodigo" 
                                         Text="{Binding PerifericoActual.Codigo, UpdateSourceTrigger=PropertyChanged}"
                                         Style="{StaticResource InputStyle}"/>
                            </StackPanel>
                              <StackPanel Grid.Row="0" Grid.Column="2">
                                <TextBlock Text="Dispositivo *" Style="{StaticResource LabelTextStyle}"/>
                                <ComboBox x:Name="CmbDispositivo" 
                                          Text="{Binding FiltroDispositivo, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                          ItemsSource="{Binding DispositivosFiltrados}"
                                          IsEditable="True"
                                          IsTextSearchEnabled="False"
                                          Style="{StaticResource InputStyle}"/>
                            </StackPanel>
                              <!-- Fila 2: Marca y Modelo -->
                            <StackPanel Grid.Row="1" Grid.Column="0">
                                <TextBlock Text="Marca" Style="{StaticResource LabelTextStyle}"/>
                                <ComboBox x:Name="CmbMarca" 
                                          Text="{Binding FiltroMarca, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                          ItemsSource="{Binding MarcasFiltradas}"
                                          IsEditable="True"
                                          IsTextSearchEnabled="False"
                                          Style="{StaticResource InputStyle}"/>
                            </StackPanel>
                            
                            <StackPanel Grid.Row="1" Grid.Column="2">
                                <TextBlock Text="Modelo" Style="{StaticResource LabelTextStyle}"/>
                                <TextBox x:Name="TxtModelo" 
                                         Text="{Binding PerifericoActual.Modelo, UpdateSourceTrigger=PropertyChanged}"
                                         Style="{StaticResource InputStyle}"/>
                            </StackPanel>
                            
                            <!-- Fila 3: Serial (span completo) -->
                            <StackPanel Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="3">
                                <TextBlock Text="Número de Serie" Style="{StaticResource LabelTextStyle}"/>
                                <TextBox x:Name="TxtSerial" 
                                         Text="{Binding PerifericoActual.Serial, UpdateSourceTrigger=PropertyChanged}"
                                         Style="{StaticResource InputStyle}"/>
                            </StackPanel>
                        </Grid>
                    </StackPanel>
                </Border>                <!-- Sección: Información Financiera -->
                <Border Background="{StaticResource SurfaceBrush}" 
                        CornerRadius="8" 
                        BorderBrush="{StaticResource BorderBrush}" 
                        BorderThickness="1"
                        Effect="{StaticResource CardShadow}"
                        Padding="24"
                        Margin="0,20,0,0">
                    <StackPanel>                        <TextBlock Text="💰 Información Financiera" 
                                   Style="{StaticResource SectionHeaderStyle}"/>
                        
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="16"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Fecha de Compra" Style="{StaticResource LabelTextStyle}"/>
                                <DatePicker x:Name="DpFechaCompra" 
                                            SelectedDate="{Binding PerifericoActual.FechaCompra, UpdateSourceTrigger=PropertyChanged}"
                                            Style="{StaticResource InputStyle}"/>
                            </StackPanel>
                            
                            <StackPanel Grid.Column="2">
                                <TextBlock Text="Costo (COP)" Style="{StaticResource LabelTextStyle}"/>
                                <TextBox x:Name="TxtCosto" 
                                         Text="{Binding PerifericoActual.Costo, UpdateSourceTrigger=PropertyChanged, StringFormat=N0}"
                                         Style="{StaticResource InputStyle}"/>
                            </StackPanel>
                        </Grid>
                    </StackPanel>
                </Border>                  <!-- Sección: Ubicación y Estado -->
                <Border Background="{StaticResource SurfaceBrush}" 
                        CornerRadius="8" 
                        BorderBrush="{StaticResource BorderBrush}" 
                        BorderThickness="1"
                        Effect="{StaticResource CardShadow}"
                        Padding="24"
                        Margin="0,20,0,0">
                    <StackPanel>                        <TextBlock Text="📍 Ubicación y Estado" 
                                   Style="{StaticResource SectionHeaderStyle}"/>
                        
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="16"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <!-- Fila 1: Sede y Estado -->
                            <StackPanel Grid.Row="0" Grid.Column="0">
                                <TextBlock Text="Sede *" Style="{StaticResource LabelTextStyle}"/>
                                <ComboBox x:Name="CmbSede" 
                                          ItemsSource="{Binding SedesDisponibles}"
                                          SelectedItem="{Binding PerifericoActual.Sede, UpdateSourceTrigger=PropertyChanged}"
                                          Style="{StaticResource InputStyle}">
                                    <ComboBox.ItemTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding Converter={StaticResource EnumToDescriptionConverter}}"/>
                                        </DataTemplate>
                                    </ComboBox.ItemTemplate>
                                </ComboBox>
                            </StackPanel>
                            
                            <StackPanel Grid.Row="0" Grid.Column="2">
                                <TextBlock Text="Estado *" Style="{StaticResource LabelTextStyle}"/>
                                <ComboBox x:Name="CmbEstado" 
                                          ItemsSource="{Binding EstadosDisponibles}"
                                          SelectedItem="{Binding PerifericoActual.Estado, UpdateSourceTrigger=PropertyChanged}"
                                          Style="{StaticResource InputStyle}">
                                    <ComboBox.ItemTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding Converter={StaticResource EnumToDescriptionConverter}}"/>
                                        </DataTemplate>
                                    </ComboBox.ItemTemplate>
                                </ComboBox>
                            </StackPanel>
                              <!-- Fila 2: Usuario Asignado (span completo) -->                            <StackPanel Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="3">
                                <TextBlock Text="Usuario Asignado" Style="{StaticResource LabelTextStyle}"/>
                                <ComboBox x:Name="CmbUsuarioAsignado"
                                          Height="40"
                                          IsEditable="True"
                                          ItemsSource="{Binding PersonasConEquipoFiltradas}"
                                          SelectedItem="{Binding PersonaConEquipoSeleccionada, Mode=TwoWay}"
                                          Text="{Binding FiltroUsuarioAsignado, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                          DisplayMemberPath="DisplayText"
                                          IsTextSearchEnabled="False"
                                          Style="{StaticResource InputStyle}"
                                          Background="{StaticResource SurfaceBrush}"
                                          BorderBrush="{StaticResource BorderBrush}"
                                          ToolTip="Buscar y seleccionar usuario con equipo asignado. Formato: Nombre Completo (Código Equipo)"/>
                            </StackPanel>
                        </Grid>
                    </StackPanel>
                </Border>                  <!-- Sección: Observaciones -->
                <Border Background="{StaticResource SurfaceBrush}" 
                        CornerRadius="8" 
                        BorderBrush="{StaticResource BorderBrush}" 
                        BorderThickness="1"
                        Effect="{StaticResource CardShadow}"
                        Padding="24"
                        Margin="0,20,0,0">
                    <StackPanel>                        <TextBlock Text="📝 Observaciones Adicionales" 
                                   Style="{StaticResource SectionHeaderStyle}"/>
                        
                        <TextBox x:Name="TxtObservaciones" 
                                 Text="{Binding PerifericoActual.Observaciones, UpdateSourceTrigger=PropertyChanged}"
                                 TextWrapping="Wrap"
                                 AcceptsReturn="True"
                                 Height="100"
                                 VerticalContentAlignment="Top"
                                 VerticalScrollBarVisibility="Auto"
                                 Style="{StaticResource InputStyle}"
                                 Margin="0,0,0,0"
                                 ToolTip="Ingrese cualquier información adicional relevante sobre el periférico"/>
                    </StackPanel>
                </Border>
                
            </StackPanel>
        </ScrollViewer>
        
        <!-- Footer con botones -->
        <Border Grid.Row="2" Background="{StaticResource SurfaceBrush}" BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,1,0,0">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="32,20">
                <Button Content="Eliminar" 
                        Command="{Binding EliminarCommand}"
                        Visibility="{Binding IsEditing, Converter={StaticResource BooleanToVisibilityConverter}}"
                        Style="{StaticResource PrimaryButtonStyle}"
                        Background="{StaticResource ErrorBrush}"
                        Foreground="White"
                        />
                <Button Content="Cancelar" 
                        Style="{StaticResource SecondaryButtonStyle}"
                        Click="BtnCancelar_Click"/>
                <Button Content="{Binding TextoBotonPrincipal}" 
                        Style="{StaticResource PrimaryButtonStyle}"
                        Command="{Binding GuardarCommand}"/>
            </StackPanel>
        </Border>
    </Grid>
</Window>
